<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hugo shortcode gallery | Yuanzhe Shi</title>
<meta name="keywords" content="css, html, hugo" />
<meta name="description" content="Creating a gallery shortcode for hugo">
<meta name="author" content="Yuanzhe Shi">
<link rel="canonical" href="https://yuanzheshi.com/posts/gallery/" />
<link crossorigin="anonymous" href="https://yuanzheshi.com/assets/css/stylesheet.min.65aebb33e4f0ce3d1a39e4a35c11b91eb08b582489fca0f78f9227d90ac72a52.css" integrity="sha256-Za67M&#43;Twzj0aOeSjXBG5HrCLWCSJ/KD3j5In2QrHKlI=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="https://yuanzheshi.com/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://yuanzheshi.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://yuanzheshi.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yuanzheshi.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://yuanzheshi.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://yuanzheshi.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.82.1" />
<meta property="og:title" content="Hugo shortcode gallery" />
<meta property="og:description" content="Creating a gallery shortcode for hugo" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanzheshi.com/posts/gallery/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-23T01:48:41&#43;08:00" />
<meta property="article:modified_time" content="2021-04-23T01:48:41&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hugo shortcode gallery"/>
<meta name="twitter:description" content="Creating a gallery shortcode for hugo"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://yuanzheshi.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Hugo shortcode gallery",
      "item": "https://yuanzheshi.com/posts/gallery/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hugo shortcode gallery",
  "name": "Hugo shortcode gallery",
  "description": "Creating a gallery shortcode for hugo",
  "keywords": [
    "css", "html", "hugo"
  ],
  "articleBody": "Apr. 18, 2021 Despite the pain during the term, it always feels empty after finishing all the finals. So I decided to work on this little project that I have planned for a long time - a gallery shortcode in hugo. My gallery before was simply cropping the images as squares and stacking them up to four columns. Athough it can fulfill the basic needs, there are several pain points:\n The thumbnail is not configured correctly, so the gallery uses the real images as thumbnails, which slows down the loading speed and My works are done in many different dimensions, and cropping them can cut away some information. The method of simply stacking square images can be aesthetically improved The images are not sort by time(instead they are sorted by file names), which means some of my oldest works got placed at the front  While the above issue can be addressed by finding and implementing existing short codes such as hugo-shortcode-gallery and hugo-easy-gallery, they are less customizable and have limitations(for example, neither support “sort by time”). Additionally, it is a lot more fun to create one on my own, especially to the purpose of passing the boring spring in Taiyuan :)\nSo let’s start by listing some criteria that I want the gallery to achieve.\n Lazy loading and thumbnails Grid layout Lightbox Sort by time(and presumably other ways) Description of images Portfolio to group related images  Looks like a lot of todos…but that’s it for today, I need to go to sleep now. zZ\nApr. 20, 2021 Apr. 21 I tried to do the sorting trick. We can access the image’s modified time using EXIF data. However, we I tried to do the following:\n{{ range sort $images .Exif }} ... {{ end }} It returns the following error:\nERROR executing \"shortcodes/gallery.html\" at : can't evaluate field Exif in type resource.Resources Seems like hugo can’t recognize some image. The problem persists when I delete all but one images with the name “whale.jpg”. However, accessing .Exif after we do {{ if eq .ResourceType \"image\" }} seems ok, so there must be some object in $images that are not image. But we used {{ $images := .Page.Resources.ByType \"image\" }} to get images!\nApr. 23 Today I have mainly worked on the hover effects and sorting.\n",
  "wordCount" : "383",
  "inLanguage": "en",
  "datePublished": "2021-04-23T01:48:41+08:00",
  "dateModified": "2021-04-23T01:48:41+08:00",
  "author":{
    "@type": "Person",
    "name": "Yuanzhe Shi"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://yuanzheshi.com/posts/gallery/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Yuanzhe Shi",
    "logo": {
      "@type": "ImageObject",
      "url": "https://yuanzheshi.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://yuanzheshi.com" accesskey="h" title="Yuanzhe Shi (Alt + H)">Yuanzhe Shi</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://yuanzheshi.com/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://yuanzheshi.com/gallery/" title="Gallery">
                    <span>Gallery</span>
                </a>
            </li>
            <li>
                <a href="https://yuanzheshi.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://yuanzheshi.com/yuanzhe_shi_resume_sep_2020_en.pdf" title="Resume">
                    <span>Resume</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Hugo shortcode gallery
    </h1>
    <div class="post-description">
      Creating a gallery shortcode for hugo
    </div>
    <div class="post-meta">April 23, 2021&nbsp;·&nbsp;Yuanzhe Shi
</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#apr-18-2021" aria-label="Apr. 18, 2021">Apr. 18, 2021</a></li>
                <li>
                    <a href="#apr-20-2021" aria-label="Apr. 20, 2021">Apr. 20, 2021</a></li>
                <li>
                    <a href="#apr-21" aria-label="Apr. 21">Apr. 21</a></li>
                <li>
                    <a href="#apr-23" aria-label="Apr. 23">Apr. 23</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="apr-18-2021">Apr. 18, 2021<a hidden class="anchor" aria-hidden="true" href="#apr-18-2021">#</a></h2>
<p>Despite the pain during the term, it always feels empty after finishing all the finals.
So I decided to work on this little project that I have planned for a long time - <strong>a gallery shortcode in hugo</strong>.
My gallery before was simply cropping the images as squares and stacking them up to four columns. Athough
it can fulfill the basic needs, there are several pain points:</p>
<ul>
<li>The thumbnail is not configured correctly, so the gallery uses the real images as thumbnails, which slows down
the loading speed and</li>
<li>My works are done in many different dimensions, and cropping them can cut away some information.</li>
<li>The method of simply stacking square images can be aesthetically improved</li>
<li>The images are not sort by time(instead they are sorted by file names), which means some of my oldest works got placed at the front</li>
</ul>
<p>While the above issue can be addressed by finding and implementing existing short codes such as <a href="https://github.com/mfg92/hugo-shortcode-gallery">hugo-shortcode-gallery</a> and <a href="https://github.com/liwenyip/hugo-easy-gallery">hugo-easy-gallery</a>, they are less customizable and have limitations(for example,
neither support &ldquo;sort by time&rdquo;). Additionally, it is a lot more fun to create one on my own, especially to the purpose of passing the boring spring in Taiyuan :)</p>
<p>So let&rsquo;s start by listing some criteria that I want the gallery to achieve.</p>
<ul>
<li>Lazy loading and thumbnails</li>
<li>Grid layout</li>
<li>Lightbox</li>
<li>Sort by time(and presumably other ways)</li>
<li>Description of images</li>
<li>Portfolio to group related images</li>
</ul>
<p>Looks like a lot of todos&hellip;but that&rsquo;s it for today, I need to go to sleep now. zZ</p>
<h2 id="apr-20-2021">Apr. 20, 2021<a hidden class="anchor" aria-hidden="true" href="#apr-20-2021">#</a></h2>
<h2 id="apr-21">Apr. 21<a hidden class="anchor" aria-hidden="true" href="#apr-21">#</a></h2>
<p>I tried to do the sorting trick. We can access the image&rsquo;s modified time using EXIF data. However, we I tried to do the following:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{{ range sort $images .Exif }}
...
{{ end }}
</code></pre></div><p>It returns the following error:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ERROR executing &#34;shortcodes/gallery.html&#34; at &lt;.Exif&gt;: can&#39;t evaluate field Exif in type resource.Resources
</code></pre></div><p>Seems like hugo can&rsquo;t recognize some image. The problem persists when I delete all but one images with the name &ldquo;whale.jpg&rdquo;. However,
accessing .Exif after we do <code>{{ if eq .ResourceType &quot;image&quot; }}</code> seems ok, so there must be some object in <code>$images</code> that are not image.
But we used <code>{{ $images := .Page.Resources.ByType &quot;image&quot; }}</code> to get images!</p>
<h2 id="apr-23">Apr. 23<a hidden class="anchor" aria-hidden="true" href="#apr-23">#</a></h2>
<p>Today I have mainly worked on the hover effects and sorting.</p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://yuanzheshi.com/tags/css/">css</a></li>
      <li><a href="https://yuanzheshi.com/tags/html/">html</a></li>
      <li><a href="https://yuanzheshi.com/tags/hugo/">hugo</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://yuanzheshi.com">Yuanzhe Shi</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
